-- MySQL Script generated by MySQL Workbench
-- Mon Apr 17 19:32:09 2023
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema bairro
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema bairro
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `bairro` DEFAULT CHARACTER SET utf8 ;
USE `bairro` ;

-- -----------------------------------------------------
-- Table `bairro`.`Bairro`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `bairro`.`Bairro` (
  `id` INT NOT NULL,
  `nome` VARCHAR(50) NULL,
  `CEP` VARCHAR(8) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `bairro`.`rua`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `bairro`.`rua` (
  `id` INT NOT NULL,
  `nome` VARCHAR(50) NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `bairro`.`rua_has_Bairro`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `bairro`.`rua_has_Bairro` (
  `rua_id` INT NOT NULL,
  `Bairro_id` INT NOT NULL,
  PRIMARY KEY (`rua_id`, `Bairro_id`),
  INDEX `fk_rua_has_Bairro_Bairro1_idx` (`Bairro_id` ASC) ,
  INDEX `fk_rua_has_Bairro_rua_idx` (`rua_id` ASC) ,
  CONSTRAINT `fk_rua_has_Bairro_rua`
    FOREIGN KEY (`rua_id`)
    REFERENCES `bairro`.`rua` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_rua_has_Bairro_Bairro1`
    FOREIGN KEY (`Bairro_id`)
    REFERENCES `bairro`.`Bairro` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;


INSERT INTO bairro (id, nome, cep)
VALUES
  (1, 'Mooca', '03122-000'),
  (2, 'Pinheiros', '05417-002'),
  (3, 'Vila Madalena', '05443-000'),
  (4, 'Ipiranga', '04211-000');

alter table bairro modify CEP varchar(9);

select * from bairro;

alter table rua add id_bairro int;
-- Inserir ruas
INSERT INTO rua (id, nome, id_bairro)
VALUES
  (1, 'Rua da Mooca', 1),
  (2, 'Rua Guaimbé', 1),
  (3, 'Rua Juventus', 1),
  (4, 'Rua dos Pinheiros', 2),
  (5, 'Rua Fradique Coutinho', 2),
  (6, 'Rua Cardeal Arcoverde', 2),
  (7, 'Rua Harmonia', 3),
  (8, 'Rua Aspicuelta', 3),
  (9, 'Rua Girassol', 3),
  (10, 'Rua Silva Bueno', 4),
  (11, 'Rua do Manifesto', 4),
  (12, 'Rua Bom Pastor', 4);

select * from rua;

-- Inserir relações muitos-para-muitos
INSERT INTO rua_has_bairro (rua_id, bairro_id)
VALUES
  (1, 1),
  (1, 2),
  (1, 3),
  (2, 4),
  (2, 5),
  (2, 6),
  (3, 7),
  (3, 8),
  (3, 9),
  (4, 10),
  (4, 11),
  (4, 12);

select * from rua_has_bairro;
select * from bairro;
select * from rua;

select bairro.nome, bairro.CEP,rua.nome
	from bairro inner join rua on
		bairro.id = rua.id_bairro;
	
